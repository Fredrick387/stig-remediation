# STIG: WN11-UR-000150 – Debug programs user right

## System / Scope
- System: Microsoft Windows 11 Pro 64-bit (Azure virtual machine, x64)
- Environment: Azure-hosted, domain-joined virtual machine in East US 2 (Zone 1)
- Role of system: User workstation endpoint used for security testing and STIG remediation within a controlled cyber range environment

## Finding
- The “Debug programs” user right (SeDebugPrivilege) was assigned beyond the required scope.
- This privilege was observed as enabled during effective privilege enumeration.

## Security Impact
- Allows a user to debug and manipulate system and other users’ processes.
- Can be abused to bypass security controls, extract credentials, or escalate privileges.

## Remediation Performed
- Restricted the SeDebugPrivilege user right to the Administrators group only.
- Enforced via Local Security Policy using `secedit`.

### PowerShell Remediation Script
```powershell
# Export current local security policy
$cfg = "$env:TEMP\secpol.cfg"
secedit /export /cfg $cfg /quiet

# Restrict SeDebugPrivilege to Administrators only
(Get-Content $cfg) |
    ForEach-Object {
        if ($_ -match '^SeDebugPrivilege') {
            'SeDebugPrivilege = *S-1-5-32-544'
        } else {
            $_
        }
    } | Set-Content $cfg

# Apply updated user rights policy
secedit /configure /db secedit.sdb /cfg $cfg /areas USER_RIGHTS /quiet
```

## Validation

- Verified SeDebugPrivilege is assigned only to the Administrators group.
- Confirmed effective privileges using whoami /priv.

## Notes

- Administrators group SID: S-1-5-32-544.
- Change applies immediately; no reboot required.
