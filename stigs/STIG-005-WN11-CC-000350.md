# STIG: WN11-CC-000350 â€“ WinRM Service must not allow unencrypted traffic

## System / Scope
- System: Microsoft Windows 11 Pro 64-bit (Azure virtual machine, x64)
- Environment: Azure-hosted, domain-joined virtual machine in East US 2 (Zone 1)
- Role of system: User workstation endpoint used for security testing and STIG remediation within a controlled cyber range environment

## Finding
- The WinRM service was not explicitly configured to block unencrypted traffic.
- Allowing unencrypted WinRM traffic exposes management sessions to interception.

## Security Impact
- Unencrypted WinRM traffic can be intercepted or modified.
- Attackers could capture sensitive management data or credentials.

## Remediation Performed
- Created the WinRM Service policy registry path.
- Disabled unencrypted WinRM traffic by enforcing the policy value.

### PowerShell Remediation Script
```powershell
New-Item -Path "HKLM:\SOFTWARE\Policies\Microsoft\Windows\WinRM\Service" -Force | Out-Null
Set-ItemProperty -Path "HKLM:\SOFTWARE\Policies\Microsoft\Windows\WinRM\Service" -Name "AllowUnencryptedTraffic" -Type DWord -Value 0
```

## Validation

- Verified unencrypted WinRM traffic is disallowed.
- Confirmed via registry inspection.

### PowerShell Validation Command
```
Get-ItemProperty -Path "HKLM:\SOFTWARE\Policies\Microsoft\Windows\WinRM\Service" -Name "AllowUnencryptedTraffic
```

## Notes
- This configuration does not affect RDP connectivity.
- WinRM continues to function using encrypted transports.
