# STIG: WN11-UR-000155 – Act as part of the operating system

## System / Scope
- System: Microsoft Windows 11 Pro 64-bit (Azure virtual machine, x64)
- Environment: Azure-hosted, domain-joined virtual machine in East US 2 (Zone 1)
- Role of system: User workstation endpoint used for security testing and STIG remediation within a controlled cyber range environment

## Finding
- The “Act as part of the operating system” user right (SeTcbPrivilege) was reviewed for improper assignment.
- Any assignment of this right represents a critical privilege escalation risk.

## Security Impact
- Grants the ability to impersonate any user and bypass authentication controls.
- Misuse allows complete system compromise and credential abuse.

## Remediation Performed
- Removed all assignments from the SeTcbPrivilege user right.
- Enforced via Local Security Policy using `secedit` to ensure no accounts retain the privilege.

### PowerShell Remediation Script
```powershell
# Export current local security policy
$cfg = "$env:TEMP\secpol.cfg"
secedit /export /cfg $cfg /quiet

# Remove any assignments to SeTcbPrivilege
(Get-Content $cfg) |
    ForEach-Object {
        if ($_ -match '^SeTcbPrivilege') {
            'SeTcbPrivilege ='
        } else {
            $_
        }
    } | Set-Content $cfg

# Apply updated user rights policy
secedit /configure /db secedit.sdb /cfg $cfg /areas USER_RIGHTS /quiet
```
## Validation

Verified no account is assigned the SeTcbPrivilege.

Confirmed effective privileges using whoami /priv.
