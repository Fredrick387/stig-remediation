# STIG: WN11-EP-000310 â€“ Kernel DMA Protection must be enabled

## System / Scope
- System: Microsoft Windows 11 Pro 64-bit (Azure virtual machine, x64)
- Environment: Azure-hosted, domain-joined virtual machine in East US 2 (Zone 1)
- Role of system: User workstation endpoint used for security testing and STIG remediation within a controlled cyber range environment

## Finding
- Kernel DMA Protection was not explicitly enforced by policy.
- Lack of enforcement increases exposure to DMA-based attacks via external devices.

## Security Impact
- Attackers with physical or virtualized DMA access could bypass OS protections.
- Sensitive memory contents may be exposed or manipulated.

## Remediation Performed
- Enforced Kernel DMA Protection policy for incompatible external devices.
- Applied policy-backed registry configuration.

### PowerShell Remediation Script
```powershell
New-Item -Path "HKLM:\SOFTWARE\Policies\Microsoft\Windows\Kernel DMA Protection" -Force | Out-Null
Set-ItemProperty `
  -Path "HKLM:\SOFTWARE\Policies\Microsoft\Windows\Kernel DMA Protection" `
  -Name "DeviceEnumerationPolicy" `
  -Type DWord `
  -Value 1
```

## Validation
- Verified Kernel DMA Protection policy is configured.
- Confirmed via registry inspection.

### PowerShell Validation Command
```
Get-ItemProperty `
  -Path "HKLM:\SOFTWARE\Policies\Microsoft\Windows\Kernel DMA Protection" `
  -Name "DeviceEnumerationPolicy"
```

## Notes
- Effective protection depends on platform support for Kernel DMA Protection.
- This configuration does not affect RDP connectivity.
