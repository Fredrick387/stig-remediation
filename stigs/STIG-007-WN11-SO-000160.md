# STIG: WN11-SO-000160 â€“ Network security: Allow LocalSystem NULL session fallback must be disabled

## System / Scope
- System: Microsoft Windows 11 Pro 64-bit (Azure virtual machine, x64)
- Environment: Azure-hosted, domain-joined virtual machine in East US 2 (Zone 1)
- Role of system: User workstation endpoint used for security testing and STIG remediation within a controlled cyber range environment

## Finding
- The system permitted NTLM LocalSystem NULL session fallback.
- Allowing NULL sessions enables unauthenticated access attempts.

## Security Impact
- Unauthenticated connections could access system resources.
- Attackers may leverage NULL sessions for enumeration or lateral movement.

## Remediation Performed
- Disabled LocalSystem NULL session fallback.
- Enforced via policy-backed registry configuration.

### PowerShell Remediation Script
```powershell
New-Item -Path "HKLM:\SYSTEM\CurrentControlSet\Control\Lsa\MSV1_0" -Force | Out-Null
Set-ItemProperty -Path "HKLM:\SYSTEM\CurrentControlSet\Control\Lsa\MSV1_0" -Name "AllowNullSessionFallback" -Type DWord -Value 0
```

## Validation
- Verified NULL session fallback is disabled.
- Confirmed via registry inspection.

### PowerShell Validation Command
```
Get-ItemProperty -Path "HKLM:\SYSTEM\CurrentControlSet\Control\Lsa\MSV1_0" -Name "AllowNullSessionFallback"
```
## Notes
- This configuration does not affect RDP connectivity.
- Prevents unauthenticated NTLM fallback behavior.
